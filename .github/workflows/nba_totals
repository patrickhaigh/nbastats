  - name: Set up R
    uses: r-lib/actions/setup-r@v2
    with:
      use-public-rspm: true
  
  - name: Install R dependencies
    uses: r-lib/actions/setup-r-dependencies@v2
    with:
      packages: |
        any::rvest
        any::httr
        any::readr
        any::dplyr
        any::stringr
        any::lubridate
        any::janitor
        any::ggplot2
  
  - name: Run scrape script
    run: Rscript R/scrape_data.R
  
  - name: Run clean script
    run: Rscript R/clean_data.R
  
  - name: Run dashboard script
    run: Rscript R/update_dashboard.R
  
  - name: Commit updated data and figures
    run: |
      git config user.name 'github-actions[bot]'
      git config user.email 'github-actions[bot]@users.noreply.github.com'
      git add data/ figs/
      git diff --staged --quiet || git commit -m "Auto update: $(date)"
      git push
